<div align="center">
  <img src="web/icons/Icon-192.png" width="96" alt="SecondLoop" />

  <h1>SecondLoop</h1>
  <p><b>Close your open loops.</b></p>
  <p>æœ¬åœ°ä¼˜å…ˆçš„ä¸ªäºº AI åŠ©æ‰‹ï¼šé•¿æœŸè®°å¿† + åŠ å¯† Vaultï¼Œé¢å‘ç§»åŠ¨ç«¯ä¸æ¡Œé¢ç«¯ã€‚</p>
  <p><a href="https://secondloop.app">https://secondloop.app</a></p>
  <p>
    ç®€ä½“ä¸­æ–‡ Â· <a href="README.md">English</a>
  </p>
  <p>
    <a href="CONTRIBUTING.md">è´¡çŒ®æŒ‡å—</a>
  </p>

</div>

> ğŸš§ **å¼€å‘ä¸­ / æœªæ­£å¼ä¸Šçº¿**
> SecondLoop æ­£åœ¨å¿«é€Ÿè¿­ä»£ä¸­ï¼Œå°šæœªæ­£å¼å‘å¸ƒã€‚çŸ­æœŸå†…å¯èƒ½å‡ºç°ç ´åæ€§å˜æ›´ï¼ˆbreaking changesï¼‰ã€‚

## âœ¨ SecondLoop æ˜¯ä»€ä¹ˆï¼Ÿ

SecondLoop æ˜¯ä¸€ä¸ªï¼ˆCommunity Editionï¼‰**å¼€æº**ã€éšç§ä¼˜å…ˆçš„ â€œSecond Brainâ€ï¼Œå¸®ä½ æ›´å¿«åœ° **æ•è·**ã€**è®°ä½**ã€å¹¶ **æ‰§è¡Œ** â€”â€” è€Œä¸æ˜¯è®©ä½ ç®¡ç†ä¸€å †æ–‡ä»¶å¤¹å’Œæ ‡ç­¾é¡µã€‚

å®ƒçš„æ ¸å¿ƒå¿ƒæ™ºæ¨¡å‹æ˜¯ **ä¸€æ¡æ—¶é—´è½´ï¼ˆMain Streamï¼‰** + ä¸€ä¸ªè½»é‡çš„ **Focus è¯­å¢ƒæ¡**ï¼šéœ€è¦æ—¶å†æ”¶çª„ä¸Šä¸‹æ–‡ï¼Œè€Œä¸æ˜¯é¢‘ç¹åˆ›å»º/åˆ‡æ¢ä¼šè¯ã€‚

## â­ äº®ç‚¹

- ğŸ§  **é•¿æœŸè®°å¿†ï¼Œæœ¬åœ°ä¼˜å…ˆ**ï¼šæ—¶é—´è½´å­˜å‚¨åœ¨æœ¬åœ°åŠ å¯†æ•°æ®åº“ä¸­ã€‚
- ğŸ§² **Ask AI + RAG**ï¼šå›ç­”ç”±æœ¬åœ°æ£€ç´¢åˆ°çš„ Topâ€‘K ç‰‡æ®µæä¾›ä¸Šä¸‹æ–‡ï¼Œæ”¯æŒæµå¼è¾“å‡ºä¸å–æ¶ˆã€‚
- ğŸ—‚ï¸ **Focus æ›¿ä»£â€œæ–°ä¼šè¯â€**ï¼šç”¨æ—¶é—´/æ ‡ç­¾ç­‰è¿‡æ»¤æ”¶çª„è¯­å¢ƒï¼Œä¸ç”¨ç®¡ç† Session åˆ—è¡¨ã€‚
- ğŸ“¥ **éšæ‰‹æ”¶é›†**ï¼šç§»åŠ¨ç«¯ Share Sheetï¼Œæ¡Œé¢ç«¯å…¨å±€å¿«æ·é”®å¿«é€Ÿæ•è·ã€‚
- ğŸ” **åŠ å¯† Vault & æ•°æ®ä¸»æƒ**ï¼šæ•°æ®ä½ç½®ç”±ä½ å†³å®šï¼›åŒæ­¥å›´ç»•ç«¯åˆ°ç«¯åŠ å¯†ï¼ˆE2EEï¼‰è®¾è®¡ã€‚
- ğŸŒ **è·¨å¹³å°**ï¼šFlutter UI + Rust Core è¦†ç›–ç§»åŠ¨ç«¯ä¸æ¡Œé¢ç«¯ã€‚

## ğŸš€ ç”¨æ³•

### è·å–æ–¹å¼

- SecondLoop **å°šæœªæ­£å¼ä¸Šçº¿**ï¼ˆæš‚æ— ç¨³å®šçš„ App Store / Play Store å‘å¸ƒï¼‰ã€‚
- æœ€æ–°åŠ¨æ€è¯·å…³æ³¨å®˜ç½‘ï¼šhttps://secondloop.app
- æƒ³ç«‹å³ä½“éªŒï¼šå¯ä»æºç æ„å»ºï¼ˆè§ä¸‹æ–¹â€œå¼€å‘è€…/è´¡çŒ®è€…â€ï¼‰ã€‚

### å¿«é€Ÿä¸Šæ‰‹

1) **åˆ›å»º Vaultï¼ˆé¦–æ¬¡å¯åŠ¨ï¼‰**
   ä½ ä¼šè®¾ç½®ä¸»å¯†ç ï¼›æœ¬åœ°æ•°æ®ä¼šä»¥åŠ å¯†æ–¹å¼è½ç›˜ã€‚

2) **æ•è·ï¼ˆSendï¼‰**
   åœ¨èŠå¤©è¾“å…¥æ¡†éšæ‰‹è®°å½•æƒ³æ³•/é“¾æ¥ï¼Œæˆ–ï¼š
   - ç§»åŠ¨ç«¯ï¼šä»å…¶ä»– App åˆ†äº«æ–‡å­—/URL/å›¾ç‰‡åˆ° SecondLoop
   - æ¡Œé¢ç«¯ï¼šæŒ‰ `âŒ˜â‡§K`ï¼ˆmacOSï¼‰/ `Ctrl+Shift+K`ï¼ˆWindows/Linuxï¼‰å¿«é€Ÿæ•è·

3) **æé—®ï¼ˆAsk AIï¼‰**
   éœ€è¦ç­”æ¡ˆæ—¶å†ç‚¹ **Ask AI**ï¼šSecondLoop ä¼šå…ˆåœ¨æœ¬åœ°æ£€ç´¢ç›¸å…³ç‰‡æ®µï¼ˆRAGï¼‰ï¼Œä»…ä¸Šä¼ å¿…è¦æ–‡æœ¬ä»¥è·å¾—å›ç­”ã€‚

4) **ç”¨ Focus æ§åˆ¶è¯­å¢ƒ**
   åˆ‡æ¢ Focusï¼ˆå¦‚â€œå…¨éƒ¨è®°å¿† / æœ€è¿‘ 7 å¤© / å·¥ä½œâ€ç­‰ï¼‰æ¥æ§åˆ¶ Ask AI çš„æ£€ç´¢èŒƒå›´ã€‚

### éšç§è¯´æ˜ï¼ˆå“ªäº›ä¼šä¸Šä¼ ï¼‰

å½“ Ask AI ä½¿ç”¨è¿œç¨‹æ¨¡å‹ï¼ˆBYOK æˆ– SecondLoop Cloudï¼‰æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šä¸Šä¼  **ä½ çš„é—®é¢˜ + å°‘é‡æœ¬åœ°æ£€ç´¢åˆ°çš„æ–‡æœ¬ç‰‡æ®µï¼ˆTopâ€‘Kï¼‰**ã€‚ä¸ä¼šä¸Šä¼ ä½ çš„å¯†é’¥ã€ä¸»å¯†ç ã€æˆ–æ•´ä¸ª Vault/å®Œæ•´å†å²ã€‚

## ğŸ§© ç‰ˆæœ¬ï¼šCommunity vs Cloud

- **Community Editionï¼ˆæœ¬ä»“åº“ï¼‰**ï¼šBYOKï¼ˆè‡ªå¸¦ Keyï¼‰ã€æœ¬åœ°ä¼˜å…ˆã€åŠ å¯† Vaultã€ä»¥åŠ BYOSï¼ˆè‡ªå¸¦å­˜å‚¨ï¼‰çš„åŒæ­¥åç«¯ã€‚
- **SecondLoop Cloudï¼ˆä»˜è´¹æ‰˜ç®¡ï¼‰**ï¼šå¯é€‰çš„æ‰˜ç®¡æœåŠ¡ï¼ˆè´¦å·ã€AI ç½‘å…³ã€æ‰˜ç®¡ Vaultã€å®æ—¶åŒæ­¥ç­‰ï¼‰ã€‚

## ğŸ“„ License

- **SecondLoop Community Editionï¼ˆæœ¬ä»“åº“ï¼‰** é‡‡ç”¨ **Apache License 2.0**ï¼Œè¯¦è§ `LICENSE`ã€‚
- **SecondLoop Cloud**ï¼ˆæ‰˜ç®¡æœåŠ¡ä¸è®¡è´¹åŸºç¡€è®¾æ–½ï¼‰ä¸åŒ…å«åœ¨æœ¬ä»“åº“ä¸­ï¼Œé‡‡ç”¨ç‹¬ç«‹å•†ä¸šæ¡æ¬¾æä¾›ã€‚

## ğŸ› ï¸ å¼€å‘è€… / è´¡çŒ®è€…

æ–°è´¡çŒ®è€…å»ºè®®ä» `CONTRIBUTING.md` å¼€å§‹ã€‚

### æŠ€æœ¯æ ˆ

- **Flutter**ï¼šè·¨å¹³å° UIï¼ˆç§»åŠ¨ç«¯ + æ¡Œé¢ç«¯ï¼‰
- **Rust**ï¼šæ ¸å¿ƒé€»è¾‘ï¼ˆé€šè¿‡ `flutter_rust_bridge`ï¼Œè´Ÿè´£ DB/åŠ å¯†/åŒæ­¥/embedding ç­‰ï¼‰
- **SQLite** + å‘é‡æ£€ç´¢ï¼ˆ`sqlite-vec`ï¼‰ï¼šç”¨äºæœ¬åœ°è®°å¿†æ£€ç´¢

### å¼€å‘ç¯å¢ƒï¼ˆPixi + FVMï¼‰

1) å®‰è£… Pixiï¼šhttps://pixi.sh

2) å¯é€‰é¢„çƒ­ï¼šæå‰å®‰è£…å›ºå®šç‰ˆæœ¬çš„ Flutter SDKï¼ˆé€šè¿‡ FVMï¼‰ï¼š

```bash
pixi run setup-flutter
```

å¦‚æœä½ ä½¿ç”¨ git worktreeï¼ˆå°¤å…¶ worktree è·¯å¾„ä¸å›ºå®š/ä¸´æ—¶ç›®å½•ï¼‰ï¼Œå»ºè®®æ¯ä¸ª worktree åˆå§‹åŒ–ä¸€æ¬¡å…±äº«ç¼“å­˜ä¸å·¥å…·é“¾ï¼š

```bash
pixi run bootstrap-shared-worktree-env
```

3) å¸¸ç”¨å‘½ä»¤ï¼š

```bash
pixi run flutter analyze
pixi run flutter test
pixi run cargo test
pixi run frb-generate
pixi run run-macos
pixi run run-linux
pixi run run-android
pixi run build-android-apk
pixi run run-windows
pixi run package-windows-msix
pixi run generate-windows-msix-cert
```

å¤‡æ³¨ï¼š
- `run-macos` ä»…åœ¨ macOS å¯ç”¨ã€‚
- `run-linux` ä»…åœ¨ Linux å¯ç”¨ã€‚
- `run-windows` ä»…åœ¨ Windows å¯ç”¨ï¼Œå¹¶ä¼šè‡ªåŠ¨æ‰§è¡Œé¢„æ£€åˆå§‹åŒ–ï¼ˆå°† `nuget.exe` ä¸‹è½½åˆ° `.tool/nuget/`ï¼Œå¹¶å°†é™æ€ `ffmpeg.exe` ä¸‹è½½åˆ° `.tool/ffmpeg/windows`ï¼‰ã€‚
- `package-windows-msix` ä»…åœ¨ Windows å¯ç”¨ï¼›å½“è®¾ç½® `SECONDLOOP_WINDOWS_MSIX_CERT_PATH`ã€`SECONDLOOP_WINDOWS_MSIX_CERT_PASSWORD`ã€`SECONDLOOP_WINDOWS_MSIX_PUBLISHER` åä¼šäº§å‡ºç­¾å MSIXã€‚
- `generate-windows-msix-cert` ä¼šç”Ÿæˆæœ¬åœ°è‡ªç­¾å `.pfx/.cer` ä¸ CI å¯ç”¨çš„ base64 æ–‡ä»¶ã€‚
- Android ç›¸å…³ä»»åŠ¡ä¼šæŠŠ SDK/NDK ä¸ Rust targets å®‰è£…åˆ° `.tool/`ï¼ˆæ— éœ€ç³»ç»Ÿçº§ Android SDKï¼‰ã€‚
- `bootstrap-shared-worktree-env` ä¼šå°† `.tool`ã€`.pixi/envs` è½¯é“¾æ¥åˆ° `git rev-parse --git-common-dir` ä¸‹çš„å…±äº«ç›®å½•ï¼Œå¹¶åœ¨å¯ç”¨æ—¶å°† `.env.local` é“¾æ¥åˆ°ä¸» worktreeï¼Œé¿å…æ¯ä¸ª worktree é‡å¤å‡†å¤‡ä¾èµ–ã€‚
- æ‰€æœ‰ `run-xxx` ä»»åŠ¡åœ¨é¦–æ¬¡æ‰§è¡Œæ—¶éƒ½ä¼šè‡ªåŠ¨è§¦å‘ `bootstrap-shared-worktree-env`ã€`setup-flutter` ä¸ `init-env`ï¼Œå› æ­¤æ–° clone åå¯ä»¥ç›´æ¥æ‰§è¡Œ `pixi run run-xxx`ã€‚
- `build-android-apk` / `build-android-apk-cn` ä¹Ÿä¼šåœ¨æ„å»ºå‰è‡ªåŠ¨è§¦å‘ `bootstrap-shared-worktree-env`ã€‚
- æ¡Œé¢è¿è¡Œä»»åŠ¡ï¼ˆ`run-macos` / `run-linux` / `run-windows`ï¼‰ä¼šåœ¨å¯åŠ¨å‰å‡†å¤‡éšåŒ… `ffmpeg`ï¼›macOS ä¼šè‡ªåŠ¨ä¸‹è½½é™æ€äºŒè¿›åˆ¶åˆ° `.tool/ffmpeg/macos`ï¼Œä¹Ÿå¯æ”¾åœ¨ `.tool` æˆ–é€šè¿‡ `--source-bin` æŒ‡å®šï¼ˆæ— éœ€ç³»ç»Ÿçº§å®‰è£…ï¼‰ã€‚
- æœ¬åœ°è°ƒè¯• `pixi run run-windows` ä¸éœ€è¦ä»»ä½• MSIX è¯ä¹¦å˜é‡ã€‚
- è‹¥è¦å®‰è£…å¯¼å‡ºçš„ `.msix` åŒ…ï¼Œå¯åœ¨ Windows æ‰§è¡Œ `powershell -ExecutionPolicy Bypass -File scripts/install_windows_msix.ps1 -MsixPath <msixæ–‡ä»¶è·¯å¾„>`ã€‚

å¦‚éœ€æ‰§è¡Œä»»æ„ Flutter/Dart/Cargo å‘½ä»¤ï¼š

```bash
pixi run flutter <command> [command-args]
# å¤šä¸ªå‚æ•°å¯æ”¾åœ¨åŒä¸€ä¸ªå¼•å·å­—ç¬¦ä¸²é‡Œï¼š
pixi run flutter test "--coverage --reporter expanded"
pixi run dart format "--output=none lib test rust_builder integration_test test_driver --set-exit-if-changed"
pixi run cargo clippy "--all-targets --all-features -- -D warnings"
```

### å¯é€‰ï¼šCloud é…ç½®ï¼ˆç»´æŠ¤è€… / è‡ªå»ºåŸºç¡€è®¾æ–½ï¼‰

- åˆ›å»ºæœ¬åœ°é…ç½®ï¼š`pixi run init-env`ï¼ˆä» `.env.example` ç”Ÿæˆ `.env.local`ï¼‰
- `pixi run flutter test` / `pixi run cargo test` ä¸éœ€è¦ä»»ä½• Cloud é…ç½®ã€‚
- Cloud ç™»å½• + Cloud Ask AIï¼ˆå¯é€‰ï¼‰éœ€è¦ï¼š
  - `SECONDLOOP_FIREBASE_WEB_API_KEY`
  - `SECONDLOOP_CLOUD_ENV=staging|prod`
  - `SECONDLOOP_CLOUD_GATEWAY_BASE_URL_STAGING` / `SECONDLOOP_CLOUD_GATEWAY_BASE_URL_PROD`
- Windows MSIX å‘ç‰ˆï¼ˆGitHub Actions `release.yml`ï¼‰è¿˜éœ€è¦ï¼š
  - `SECONDLOOP_WINDOWS_MSIX_CERT_BASE64`ï¼ˆbase64 ç¼–ç çš„ `.pfx`ï¼‰
  - `SECONDLOOP_WINDOWS_MSIX_CERT_PASSWORD`
  - `SECONDLOOP_WINDOWS_MSIX_PUBLISHER`ï¼ˆå¿…é¡»ä¸è¯ä¹¦ Subject ä¸€è‡´ï¼Œä¾‹å¦‚ `CN=SecondLoop Dev`ï¼‰

### æ’é”™

- å¦‚æœåœ¨ Windows çœ‹åˆ°æ„å»ºé”™è¯¯å¼•ç”¨äº† macOS è·¯å¾„ï¼ˆå¦‚ `/Users/.../fvm/versions/...`ï¼‰ï¼Œåˆ é™¤ç”Ÿæˆçš„ Flutter æ„å»ºäº§ç‰©ï¼ˆæˆ–æ‰§è¡Œ `dart pub global run fvm:main flutter clean`ï¼‰ï¼Œç„¶åé‡æ–°è·‘ `pixi run setup-flutter`ã€‚
- å¦‚æœ `flutter pub get` è®¿é—® `https://pub.dev` å‡ºç° TLS é”™è¯¯ï¼Œå¯å°è¯• `export PUB_HOSTED_URL=https://pub.flutter-io.cn` åé‡è¯•ã€‚

### å¹³å°å‰ç½®ä¾èµ–

- Androidï¼šå¯é€‰ Android Studioã€‚Pixi ä»»åŠ¡ä¼šæŠŠ SDK/NDK + Rust å·¥å…·é“¾å®‰è£…åˆ° `.tool/`ï¼ˆå¯ç”¨ `pixi run flutter doctor -v` éªŒè¯ï¼‰ã€‚
- Windowsï¼ˆå¼€å‘/æ„å»ºï¼‰ï¼šVisual Studio 2022 + Desktop development with C++ + ç»„ä»¶ `C++ ATL for latest v143 build tools (x86 & x64)`ï¼ˆç”¨äº `atlstr.h`ï¼‰ã€‚ç»ˆç«¯ç”¨æˆ·ä¸éœ€è¦ VS/ATLï¼ˆå¯èƒ½éœ€è¦ VC++ runtimeï¼Œå®‰è£…å™¨åº”åŒ…å«ï¼‰ã€‚
- macOS/iOSï¼šXcode + Command Line Tools
